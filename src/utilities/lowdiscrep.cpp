#include "lowdiscrep.h"
#include "log.h"

namespace LowDiscrepancy {

static Random rng;

template <int base>
static float radicalInverseSpecialized(uint64_t a) {
    constexpr float invBase = 1.0f / base;
    uint64_t reversedDigits = 0;
    float invBaseN = 1;
    while (a) {
        uint64_t next = a / base;
        uint64_t digit = a - next * base;
        reversedDigits = reversedDigits * base + digit;
        invBaseN *= invBase;
        a = next;
    }
    return min(reversedDigits * invBaseN, Random::OneMinusEpsilon);
}

template <int base>
static float scrambledRadicalInverseSpecialized(const uint16_t *perm, uint64_t a) {
    constexpr float invBase = 1.0f / base;
    uint64_t reversedDigits = 0;
    float invBaseN = 1;
    while (a) {
        uint64_t next = a / base;
        uint64_t digit = a - next * base;
        CHECK_LT(perm[digit], base);
        reversedDigits = reversedDigits * base + perm[digit];
        invBaseN *= invBase;
        a = next;
    }
    return min(invBaseN * (reversedDigits + invBase * perm[0] / (1 - invBase)), Random::OneMinusEpsilon);
}

#define RAD_INV(index, base) case index: return radicalInverseSpecialized<base>(a)

float radicalInverse(int baseIndex, uint64_t a) {
    switch (baseIndex) {
    case 0: return reverseBits64(a) * 0x1p-64f;
        RAD_INV(1, 3); RAD_INV(2, 5); RAD_INV(3, 7); RAD_INV(4, 11); RAD_INV(5, 13);
        RAD_INV(6, 17); RAD_INV(7, 19); RAD_INV(8, 23); RAD_INV(9, 29); RAD_INV(10, 31);
        RAD_INV(11, 37); RAD_INV(12, 41); RAD_INV(13, 43); RAD_INV(14, 47); RAD_INV(15, 53);
        RAD_INV(16, 59); RAD_INV(17, 61); RAD_INV(18, 67); RAD_INV(19, 71); RAD_INV(20, 73);
        RAD_INV(21, 79); RAD_INV(22, 83); RAD_INV(23, 89); RAD_INV(24, 97); RAD_INV(25, 101);
        RAD_INV(26, 103); RAD_INV(27, 107); RAD_INV(28, 109); RAD_INV(29, 113); RAD_INV(30, 127);
        RAD_INV(31, 131); RAD_INV(32, 137); RAD_INV(33, 139); RAD_INV(34, 149); RAD_INV(35, 151);
        RAD_INV(36, 157); RAD_INV(37, 163); RAD_INV(38, 167); RAD_INV(39, 173); RAD_INV(40, 179);
        RAD_INV(41, 181); RAD_INV(42, 191); RAD_INV(43, 193); RAD_INV(44, 197); RAD_INV(45, 199);
        RAD_INV(46, 211); RAD_INV(47, 223); RAD_INV(48, 227); RAD_INV(49, 229); RAD_INV(50, 233);
        RAD_INV(51, 239); RAD_INV(52, 241); RAD_INV(53, 251); RAD_INV(54, 257); RAD_INV(55, 263);
        RAD_INV(56, 269); RAD_INV(57, 271); RAD_INV(58, 277); RAD_INV(59, 281); RAD_INV(60, 283);
        RAD_INV(61, 293); RAD_INV(62, 307); RAD_INV(63, 311); RAD_INV(64, 313); RAD_INV(65, 317);
        RAD_INV(66, 331); RAD_INV(67, 337); RAD_INV(68, 347); RAD_INV(69, 349); RAD_INV(70, 353);
        RAD_INV(71, 359); RAD_INV(72, 367); RAD_INV(73, 373); RAD_INV(74, 379); RAD_INV(75, 383);
        RAD_INV(76, 389); RAD_INV(77, 397); RAD_INV(78, 401); RAD_INV(79, 409); RAD_INV(80, 419);
        RAD_INV(81, 421); RAD_INV(82, 431); RAD_INV(83, 433); RAD_INV(84, 439); RAD_INV(85, 443);
        RAD_INV(86, 449); RAD_INV(87, 457); RAD_INV(88, 461); RAD_INV(89, 463); RAD_INV(90, 467);
        RAD_INV(91, 479); RAD_INV(92, 487); RAD_INV(93, 491); RAD_INV(94, 499); RAD_INV(95, 503);
        RAD_INV(96, 509); RAD_INV(97, 521); RAD_INV(98, 523); RAD_INV(99, 541); RAD_INV(100, 547);
        RAD_INV(101, 557); RAD_INV(102, 563); RAD_INV(103, 569); RAD_INV(104, 571); RAD_INV(105, 577);
        RAD_INV(106, 587); RAD_INV(107, 593); RAD_INV(108, 599); RAD_INV(109, 601); RAD_INV(110, 607);
        RAD_INV(111, 613); RAD_INV(112, 617); RAD_INV(113, 619); RAD_INV(114, 631); RAD_INV(115, 641);
        RAD_INV(116, 643); RAD_INV(117, 647); RAD_INV(118, 653); RAD_INV(119, 659); RAD_INV(120, 661);
        RAD_INV(121, 673); RAD_INV(122, 677); RAD_INV(123, 683); RAD_INV(124, 691); RAD_INV(125, 701);
        RAD_INV(126, 709); RAD_INV(127, 719); RAD_INV(128, 727); RAD_INV(129, 733); RAD_INV(130, 739);
        RAD_INV(131, 743); RAD_INV(132, 751); RAD_INV(133, 757); RAD_INV(134, 761); RAD_INV(135, 769);
        RAD_INV(136, 773); RAD_INV(137, 787); RAD_INV(138, 797); RAD_INV(139, 809); RAD_INV(140, 811);
        RAD_INV(141, 821); RAD_INV(142, 823); RAD_INV(143, 827); RAD_INV(144, 829); RAD_INV(145, 839);
        RAD_INV(146, 853); RAD_INV(147, 857); RAD_INV(148, 859); RAD_INV(149, 863); RAD_INV(150, 877);
        RAD_INV(151, 881); RAD_INV(152, 883); RAD_INV(153, 887); RAD_INV(154, 907); RAD_INV(155, 911);
        RAD_INV(156, 919); RAD_INV(157, 929); RAD_INV(158, 937); RAD_INV(159, 941); RAD_INV(160, 947);
        RAD_INV(161, 953); RAD_INV(162, 967); RAD_INV(163, 971); RAD_INV(164, 977); RAD_INV(165, 983);
        RAD_INV(166, 991); RAD_INV(167, 997); RAD_INV(168, 1009); RAD_INV(169, 1013); RAD_INV(170, 1019);
        RAD_INV(171, 1021); RAD_INV(172, 1031); RAD_INV(173, 1033); RAD_INV(174, 1039); RAD_INV(175, 1049);
        RAD_INV(176, 1051); RAD_INV(177, 1061); RAD_INV(178, 1063); RAD_INV(179, 1069); RAD_INV(180, 1087);
        RAD_INV(181, 1091); RAD_INV(182, 1093); RAD_INV(183, 1097); RAD_INV(184, 1103); RAD_INV(185, 1109);
        RAD_INV(186, 1117); RAD_INV(187, 1123); RAD_INV(188, 1129); RAD_INV(189, 1151); RAD_INV(190, 1153);
        RAD_INV(191, 1163); RAD_INV(192, 1171); RAD_INV(193, 1181); RAD_INV(194, 1187); RAD_INV(195, 1193);
        RAD_INV(196, 1201); RAD_INV(197, 1213); RAD_INV(198, 1217); RAD_INV(199, 1223); RAD_INV(200, 1229);
        RAD_INV(201, 1231); RAD_INV(202, 1237); RAD_INV(203, 1249); RAD_INV(204, 1259); RAD_INV(205, 1277);
        RAD_INV(206, 1279); RAD_INV(207, 1283); RAD_INV(208, 1289); RAD_INV(209, 1291); RAD_INV(210, 1297);
        RAD_INV(211, 1301); RAD_INV(212, 1303); RAD_INV(213, 1307); RAD_INV(214, 1319); RAD_INV(215, 1321);
        RAD_INV(216, 1327); RAD_INV(217, 1361); RAD_INV(218, 1367); RAD_INV(219, 1373); RAD_INV(220, 1381);
        RAD_INV(221, 1399); RAD_INV(222, 1409); RAD_INV(223, 1423); RAD_INV(224, 1427); RAD_INV(225, 1429);
        RAD_INV(226, 1433); RAD_INV(227, 1439); RAD_INV(228, 1447); RAD_INV(229, 1451); RAD_INV(230, 1453);
        RAD_INV(231, 1459); RAD_INV(232, 1471); RAD_INV(233, 1481); RAD_INV(234, 1483); RAD_INV(235, 1487);
        RAD_INV(236, 1489); RAD_INV(237, 1493); RAD_INV(238, 1499); RAD_INV(239, 1511); RAD_INV(240, 1523);
        RAD_INV(241, 1531); RAD_INV(242, 1543); RAD_INV(243, 1549); RAD_INV(244, 1553); RAD_INV(245, 1559);
        RAD_INV(246, 1567); RAD_INV(247, 1571); RAD_INV(248, 1579); RAD_INV(249, 1583); RAD_INV(250, 1597);
        RAD_INV(251, 1601); RAD_INV(252, 1607); RAD_INV(253, 1609); RAD_INV(254, 1613); RAD_INV(255, 1619);
        RAD_INV(256, 1621); RAD_INV(257, 1627); RAD_INV(258, 1637); RAD_INV(259, 1657); RAD_INV(260, 1663);
        RAD_INV(261, 1667); RAD_INV(262, 1669); RAD_INV(263, 1693); RAD_INV(264, 1697); RAD_INV(265, 1699);
        RAD_INV(266, 1709); RAD_INV(267, 1721); RAD_INV(268, 1723); RAD_INV(269, 1733); RAD_INV(270, 1741);
        RAD_INV(271, 1747); RAD_INV(272, 1753); RAD_INV(273, 1759); RAD_INV(274, 1777); RAD_INV(275, 1783);
        RAD_INV(276, 1787); RAD_INV(277, 1789); RAD_INV(278, 1801); RAD_INV(279, 1811); RAD_INV(280, 1823);
        RAD_INV(281, 1831); RAD_INV(282, 1847); RAD_INV(283, 1861); RAD_INV(284, 1867); RAD_INV(285, 1871);
        RAD_INV(286, 1873); RAD_INV(287, 1877); RAD_INV(288, 1879); RAD_INV(289, 1889); RAD_INV(290, 1901);
        RAD_INV(291, 1907); RAD_INV(292, 1913); RAD_INV(293, 1931); RAD_INV(294, 1933); RAD_INV(295, 1949);
        RAD_INV(296, 1951); RAD_INV(297, 1973); RAD_INV(298, 1979); RAD_INV(299, 1987); RAD_INV(300, 1993);
        RAD_INV(301, 1997); RAD_INV(302, 1999); RAD_INV(303, 2003); RAD_INV(304, 2011); RAD_INV(305, 2017);
        RAD_INV(306, 2027); RAD_INV(307, 2029); RAD_INV(308, 2039); RAD_INV(309, 2053); RAD_INV(310, 2063);
        RAD_INV(311, 2069); RAD_INV(312, 2081); RAD_INV(313, 2083); RAD_INV(314, 2087); RAD_INV(315, 2089);
        RAD_INV(316, 2099); RAD_INV(317, 2111); RAD_INV(318, 2113); RAD_INV(319, 2129); RAD_INV(320, 2131);
        RAD_INV(321, 2137); RAD_INV(322, 2141); RAD_INV(323, 2143); RAD_INV(324, 2153); RAD_INV(325, 2161);
        RAD_INV(326, 2179); RAD_INV(327, 2203); RAD_INV(328, 2207); RAD_INV(329, 2213); RAD_INV(330, 2221);
        RAD_INV(331, 2237); RAD_INV(332, 2239); RAD_INV(333, 2243); RAD_INV(334, 2251); RAD_INV(335, 2267);
        RAD_INV(336, 2269); RAD_INV(337, 2273); RAD_INV(338, 2281); RAD_INV(339, 2287); RAD_INV(340, 2293);
        RAD_INV(341, 2297); RAD_INV(342, 2309); RAD_INV(343, 2311); RAD_INV(344, 2333); RAD_INV(345, 2339);
        RAD_INV(346, 2341); RAD_INV(347, 2347); RAD_INV(348, 2351); RAD_INV(349, 2357); RAD_INV(350, 2371);
        RAD_INV(351, 2377); RAD_INV(352, 2381); RAD_INV(353, 2383); RAD_INV(354, 2389); RAD_INV(355, 2393);
        RAD_INV(356, 2399); RAD_INV(357, 2411); RAD_INV(358, 2417); RAD_INV(359, 2423); RAD_INV(360, 2437);
        RAD_INV(361, 2441); RAD_INV(362, 2447); RAD_INV(363, 2459); RAD_INV(364, 2467); RAD_INV(365, 2473);
        RAD_INV(366, 2477); RAD_INV(367, 2503); RAD_INV(368, 2521); RAD_INV(369, 2531); RAD_INV(370, 2539);
        RAD_INV(371, 2543); RAD_INV(372, 2549); RAD_INV(373, 2551); RAD_INV(374, 2557); RAD_INV(375, 2579);
        RAD_INV(376, 2591); RAD_INV(377, 2593); RAD_INV(378, 2609); RAD_INV(379, 2617); RAD_INV(380, 2621);
        RAD_INV(381, 2633); RAD_INV(382, 2647); RAD_INV(383, 2657); RAD_INV(384, 2659); RAD_INV(385, 2663);
        RAD_INV(386, 2671); RAD_INV(387, 2677); RAD_INV(388, 2683); RAD_INV(389, 2687); RAD_INV(390, 2689);
        RAD_INV(391, 2693); RAD_INV(392, 2699); RAD_INV(393, 2707); RAD_INV(394, 2711); RAD_INV(395, 2713);
        RAD_INV(396, 2719); RAD_INV(397, 2729); RAD_INV(398, 2731); RAD_INV(399, 2741); RAD_INV(400, 2749);
        RAD_INV(401, 2753); RAD_INV(402, 2767); RAD_INV(403, 2777); RAD_INV(404, 2789); RAD_INV(405, 2791);
        RAD_INV(406, 2797); RAD_INV(407, 2801); RAD_INV(408, 2803); RAD_INV(409, 2819); RAD_INV(410, 2833);
        RAD_INV(411, 2837); RAD_INV(412, 2843); RAD_INV(413, 2851); RAD_INV(414, 2857); RAD_INV(415, 2861);
        RAD_INV(416, 2879); RAD_INV(417, 2887); RAD_INV(418, 2897); RAD_INV(419, 2903); RAD_INV(420, 2909);
        RAD_INV(421, 2917); RAD_INV(422, 2927); RAD_INV(423, 2939); RAD_INV(424, 2953); RAD_INV(425, 2957);
        RAD_INV(426, 2963); RAD_INV(427, 2969); RAD_INV(428, 2971); RAD_INV(429, 2999); RAD_INV(430, 3001);
        RAD_INV(431, 3011); RAD_INV(432, 3019); RAD_INV(433, 3023); RAD_INV(434, 3037); RAD_INV(435, 3041);
        RAD_INV(436, 3049); RAD_INV(437, 3061); RAD_INV(438, 3067); RAD_INV(439, 3079); RAD_INV(440, 3083);
        RAD_INV(441, 3089); RAD_INV(442, 3109); RAD_INV(443, 3119); RAD_INV(444, 3121); RAD_INV(445, 3137);
        RAD_INV(446, 3163); RAD_INV(447, 3167); RAD_INV(448, 3169); RAD_INV(449, 3181); RAD_INV(450, 3187);
        RAD_INV(451, 3191); RAD_INV(452, 3203); RAD_INV(453, 3209); RAD_INV(454, 3217); RAD_INV(455, 3221);
        RAD_INV(456, 3229); RAD_INV(457, 3251); RAD_INV(458, 3253); RAD_INV(459, 3257); RAD_INV(460, 3259);
        RAD_INV(461, 3271); RAD_INV(462, 3299); RAD_INV(463, 3301); RAD_INV(464, 3307); RAD_INV(465, 3313);
        RAD_INV(466, 3319); RAD_INV(467, 3323); RAD_INV(468, 3329); RAD_INV(469, 3331); RAD_INV(470, 3343);
        RAD_INV(471, 3347); RAD_INV(472, 3359); RAD_INV(473, 3361); RAD_INV(474, 3371); RAD_INV(475, 3373);
        RAD_INV(476, 3389); RAD_INV(477, 3391); RAD_INV(478, 3407); RAD_INV(479, 3413); RAD_INV(480, 3433);
        RAD_INV(481, 3449); RAD_INV(482, 3457); RAD_INV(483, 3461); RAD_INV(484, 3463); RAD_INV(485, 3467);
        RAD_INV(486, 3469); RAD_INV(487, 3491); RAD_INV(488, 3499); RAD_INV(489, 3511); RAD_INV(490, 3517);
        RAD_INV(491, 3527); RAD_INV(492, 3529); RAD_INV(493, 3533); RAD_INV(494, 3539); RAD_INV(495, 3541);
        RAD_INV(496, 3547); RAD_INV(497, 3557); RAD_INV(498, 3559); RAD_INV(499, 3571); RAD_INV(500, 3581);
        RAD_INV(501, 3583); RAD_INV(502, 3593); RAD_INV(503, 3607); RAD_INV(504, 3613); RAD_INV(505, 3617);
        RAD_INV(506, 3623); RAD_INV(507, 3631); RAD_INV(508, 3637); RAD_INV(509, 3643); RAD_INV(510, 3659);
        RAD_INV(511, 3671); RAD_INV(512, 3673); RAD_INV(513, 3677); RAD_INV(514, 3691); RAD_INV(515, 3697);
        RAD_INV(516, 3701); RAD_INV(517, 3709); RAD_INV(518, 3719); RAD_INV(519, 3727); RAD_INV(520, 3733);
        RAD_INV(521, 3739); RAD_INV(522, 3761); RAD_INV(523, 3767); RAD_INV(524, 3769); RAD_INV(525, 3779);
        RAD_INV(526, 3793); RAD_INV(527, 3797); RAD_INV(528, 3803); RAD_INV(529, 3821); RAD_INV(530, 3823);
        RAD_INV(531, 3833); RAD_INV(532, 3847); RAD_INV(533, 3851); RAD_INV(534, 3853); RAD_INV(535, 3863);
        RAD_INV(536, 3877); RAD_INV(537, 3881); RAD_INV(538, 3889); RAD_INV(539, 3907); RAD_INV(540, 3911);
        RAD_INV(541, 3917); RAD_INV(542, 3919); RAD_INV(543, 3923); RAD_INV(544, 3929); RAD_INV(545, 3931);
        RAD_INV(546, 3943); RAD_INV(547, 3947); RAD_INV(548, 3967); RAD_INV(549, 3989); RAD_INV(550, 4001);
        RAD_INV(551, 4003); RAD_INV(552, 4007); RAD_INV(553, 4013); RAD_INV(554, 4019); RAD_INV(555, 4021);
        RAD_INV(556, 4027); RAD_INV(557, 4049); RAD_INV(558, 4051); RAD_INV(559, 4057); RAD_INV(560, 4073);
        RAD_INV(561, 4079); RAD_INV(562, 4091); RAD_INV(563, 4093); RAD_INV(564, 4099); RAD_INV(565, 4111);
        RAD_INV(566, 4127); RAD_INV(567, 4129); RAD_INV(568, 4133); RAD_INV(569, 4139); RAD_INV(570, 4153);
        RAD_INV(571, 4157); RAD_INV(572, 4159); RAD_INV(573, 4177); RAD_INV(574, 4201); RAD_INV(575, 4211);
        RAD_INV(576, 4217); RAD_INV(577, 4219); RAD_INV(578, 4229); RAD_INV(579, 4231); RAD_INV(580, 4241);
        RAD_INV(581, 4243); RAD_INV(582, 4253); RAD_INV(583, 4259); RAD_INV(584, 4261); RAD_INV(585, 4271);
        RAD_INV(586, 4273); RAD_INV(587, 4283); RAD_INV(588, 4289); RAD_INV(589, 4297); RAD_INV(590, 4327);
        RAD_INV(591, 4337); RAD_INV(592, 4339); RAD_INV(593, 4349); RAD_INV(594, 4357); RAD_INV(595, 4363);
        RAD_INV(596, 4373); RAD_INV(597, 4391); RAD_INV(598, 4397); RAD_INV(599, 4409); RAD_INV(600, 4421);
        RAD_INV(601, 4423); RAD_INV(602, 4441); RAD_INV(603, 4447); RAD_INV(604, 4451); RAD_INV(605, 4457);
        RAD_INV(606, 4463); RAD_INV(607, 4481); RAD_INV(608, 4483); RAD_INV(609, 4493); RAD_INV(610, 4507);
        RAD_INV(611, 4513); RAD_INV(612, 4517); RAD_INV(613, 4519); RAD_INV(614, 4523); RAD_INV(615, 4547);
        RAD_INV(616, 4549); RAD_INV(617, 4561); RAD_INV(618, 4567); RAD_INV(619, 4583); RAD_INV(620, 4591);
        RAD_INV(621, 4597); RAD_INV(622, 4603); RAD_INV(623, 4621); RAD_INV(624, 4637); RAD_INV(625, 4639);
        RAD_INV(626, 4643); RAD_INV(627, 4649); RAD_INV(628, 4651); RAD_INV(629, 4657); RAD_INV(630, 4663);
        RAD_INV(631, 4673); RAD_INV(632, 4679); RAD_INV(633, 4691); RAD_INV(634, 4703); RAD_INV(635, 4721);
        RAD_INV(636, 4723); RAD_INV(637, 4729); RAD_INV(638, 4733); RAD_INV(639, 4751); RAD_INV(640, 4759);
        RAD_INV(641, 4783); RAD_INV(642, 4787); RAD_INV(643, 4789); RAD_INV(644, 4793); RAD_INV(645, 4799);
        RAD_INV(646, 4801); RAD_INV(647, 4813); RAD_INV(648, 4817); RAD_INV(649, 4831); RAD_INV(650, 4861);
        RAD_INV(651, 4871); RAD_INV(652, 4877); RAD_INV(653, 4889); RAD_INV(654, 4903); RAD_INV(655, 4909);
        RAD_INV(656, 4919); RAD_INV(657, 4931); RAD_INV(658, 4933); RAD_INV(659, 4937); RAD_INV(660, 4943);
        RAD_INV(661, 4951); RAD_INV(662, 4957); RAD_INV(663, 4967); RAD_INV(664, 4969); RAD_INV(665, 4973);
        RAD_INV(666, 4987); RAD_INV(667, 4993); RAD_INV(668, 4999); RAD_INV(669, 5003); RAD_INV(670, 5009);
        RAD_INV(671, 5011); RAD_INV(672, 5021); RAD_INV(673, 5023); RAD_INV(674, 5039); RAD_INV(675, 5051);
        RAD_INV(676, 5059); RAD_INV(677, 5077); RAD_INV(678, 5081); RAD_INV(679, 5087); RAD_INV(680, 5099);
        RAD_INV(681, 5101); RAD_INV(682, 5107); RAD_INV(683, 5113); RAD_INV(684, 5119); RAD_INV(685, 5147);
        RAD_INV(686, 5153); RAD_INV(687, 5167); RAD_INV(688, 5171); RAD_INV(689, 5179); RAD_INV(690, 5189);
        RAD_INV(691, 5197); RAD_INV(692, 5209); RAD_INV(693, 5227); RAD_INV(694, 5231); RAD_INV(695, 5233);
        RAD_INV(696, 5237); RAD_INV(697, 5261); RAD_INV(698, 5273); RAD_INV(699, 5279); RAD_INV(700, 5281);
        RAD_INV(701, 5297); RAD_INV(702, 5303); RAD_INV(703, 5309); RAD_INV(704, 5323); RAD_INV(705, 5333);
        RAD_INV(706, 5347); RAD_INV(707, 5351); RAD_INV(708, 5381); RAD_INV(709, 5387); RAD_INV(710, 5393);
        RAD_INV(711, 5399); RAD_INV(712, 5407); RAD_INV(713, 5413); RAD_INV(714, 5417); RAD_INV(715, 5419);
        RAD_INV(716, 5431); RAD_INV(717, 5437); RAD_INV(718, 5441); RAD_INV(719, 5443); RAD_INV(720, 5449);
        RAD_INV(721, 5471); RAD_INV(722, 5477); RAD_INV(723, 5479); RAD_INV(724, 5483); RAD_INV(725, 5501);
        RAD_INV(726, 5503); RAD_INV(727, 5507); RAD_INV(728, 5519); RAD_INV(729, 5521); RAD_INV(730, 5527);
        RAD_INV(731, 5531); RAD_INV(732, 5557); RAD_INV(733, 5563); RAD_INV(734, 5569); RAD_INV(735, 5573);
        RAD_INV(736, 5581); RAD_INV(737, 5591); RAD_INV(738, 5623); RAD_INV(739, 5639); RAD_INV(740, 5641);
        RAD_INV(741, 5647); RAD_INV(742, 5651); RAD_INV(743, 5653); RAD_INV(744, 5657); RAD_INV(745, 5659);
        RAD_INV(746, 5669); RAD_INV(747, 5683); RAD_INV(748, 5689); RAD_INV(749, 5693); RAD_INV(750, 5701);
        RAD_INV(751, 5711); RAD_INV(752, 5717); RAD_INV(753, 5737); RAD_INV(754, 5741); RAD_INV(755, 5743);
        RAD_INV(756, 5749); RAD_INV(757, 5779); RAD_INV(758, 5783); RAD_INV(759, 5791); RAD_INV(760, 5801);
        RAD_INV(761, 5807); RAD_INV(762, 5813); RAD_INV(763, 5821); RAD_INV(764, 5827); RAD_INV(765, 5839);
        RAD_INV(766, 5843); RAD_INV(767, 5849); RAD_INV(768, 5851); RAD_INV(769, 5857); RAD_INV(770, 5861);
        RAD_INV(771, 5867); RAD_INV(772, 5869); RAD_INV(773, 5879); RAD_INV(774, 5881); RAD_INV(775, 5897);
        RAD_INV(776, 5903); RAD_INV(777, 5923); RAD_INV(778, 5927); RAD_INV(779, 5939); RAD_INV(780, 5953);
        RAD_INV(781, 5981); RAD_INV(782, 5987); RAD_INV(783, 6007); RAD_INV(784, 6011); RAD_INV(785, 6029);
        RAD_INV(786, 6037); RAD_INV(787, 6043); RAD_INV(788, 6047); RAD_INV(789, 6053); RAD_INV(790, 6067);
        RAD_INV(791, 6073); RAD_INV(792, 6079); RAD_INV(793, 6089); RAD_INV(794, 6091); RAD_INV(795, 6101);
        RAD_INV(796, 6113); RAD_INV(797, 6121); RAD_INV(798, 6131); RAD_INV(799, 6133); RAD_INV(800, 6143);
        RAD_INV(801, 6151); RAD_INV(802, 6163); RAD_INV(803, 6173); RAD_INV(804, 6197); RAD_INV(805, 6199);
        RAD_INV(806, 6203); RAD_INV(807, 6211); RAD_INV(808, 6217); RAD_INV(809, 6221); RAD_INV(810, 6229);
        RAD_INV(811, 6247); RAD_INV(812, 6257); RAD_INV(813, 6263); RAD_INV(814, 6269); RAD_INV(815, 6271);
        RAD_INV(816, 6277); RAD_INV(817, 6287); RAD_INV(818, 6299); RAD_INV(819, 6301); RAD_INV(820, 6311);
        RAD_INV(821, 6317); RAD_INV(822, 6323); RAD_INV(823, 6329); RAD_INV(824, 6337); RAD_INV(825, 6343);
        RAD_INV(826, 6353); RAD_INV(827, 6359); RAD_INV(828, 6361); RAD_INV(829, 6367); RAD_INV(830, 6373);
        RAD_INV(831, 6379); RAD_INV(832, 6389); RAD_INV(833, 6397); RAD_INV(834, 6421); RAD_INV(835, 6427);
        RAD_INV(836, 6449); RAD_INV(837, 6451); RAD_INV(838, 6469); RAD_INV(839, 6473); RAD_INV(840, 6481);
        RAD_INV(841, 6491); RAD_INV(842, 6521); RAD_INV(843, 6529); RAD_INV(844, 6547); RAD_INV(845, 6551);
        RAD_INV(846, 6553); RAD_INV(847, 6563); RAD_INV(848, 6569); RAD_INV(849, 6571); RAD_INV(850, 6577);
        RAD_INV(851, 6581); RAD_INV(852, 6599); RAD_INV(853, 6607); RAD_INV(854, 6619); RAD_INV(855, 6637);
        RAD_INV(856, 6653); RAD_INV(857, 6659); RAD_INV(858, 6661); RAD_INV(859, 6673); RAD_INV(860, 6679);
        RAD_INV(861, 6689); RAD_INV(862, 6691); RAD_INV(863, 6701); RAD_INV(864, 6703); RAD_INV(865, 6709);
        RAD_INV(866, 6719); RAD_INV(867, 6733); RAD_INV(868, 6737); RAD_INV(869, 6761); RAD_INV(870, 6763);
        RAD_INV(871, 6779); RAD_INV(872, 6781); RAD_INV(873, 6791); RAD_INV(874, 6793); RAD_INV(875, 6803);
        RAD_INV(876, 6823); RAD_INV(877, 6827); RAD_INV(878, 6829); RAD_INV(879, 6833); RAD_INV(880, 6841);
        RAD_INV(881, 6857); RAD_INV(882, 6863); RAD_INV(883, 6869); RAD_INV(884, 6871); RAD_INV(885, 6883);
        RAD_INV(886, 6899); RAD_INV(887, 6907); RAD_INV(888, 6911); RAD_INV(889, 6917); RAD_INV(890, 6947);
        RAD_INV(891, 6949); RAD_INV(892, 6959); RAD_INV(893, 6961); RAD_INV(894, 6967); RAD_INV(895, 6971);
        RAD_INV(896, 6977); RAD_INV(897, 6983); RAD_INV(898, 6991); RAD_INV(899, 6997); RAD_INV(900, 7001);
        RAD_INV(901, 7013); RAD_INV(902, 7019); RAD_INV(903, 7027); RAD_INV(904, 7039); RAD_INV(905, 7043);
        RAD_INV(906, 7057); RAD_INV(907, 7069); RAD_INV(908, 7079); RAD_INV(909, 7103); RAD_INV(910, 7109);
        RAD_INV(911, 7121); RAD_INV(912, 7127); RAD_INV(913, 7129); RAD_INV(914, 7151); RAD_INV(915, 7159);
        RAD_INV(916, 7177); RAD_INV(917, 7187); RAD_INV(918, 7193); RAD_INV(919, 7207); RAD_INV(920, 7211);
        RAD_INV(921, 7213); RAD_INV(922, 7219); RAD_INV(923, 7229); RAD_INV(924, 7237); RAD_INV(925, 7243);
        RAD_INV(926, 7247); RAD_INV(927, 7253); RAD_INV(928, 7283); RAD_INV(929, 7297); RAD_INV(930, 7307);
        RAD_INV(931, 7309); RAD_INV(932, 7321); RAD_INV(933, 7331); RAD_INV(934, 7333); RAD_INV(935, 7349);
        RAD_INV(936, 7351); RAD_INV(937, 7369); RAD_INV(938, 7393); RAD_INV(939, 7411); RAD_INV(940, 7417);
        RAD_INV(941, 7433); RAD_INV(942, 7451); RAD_INV(943, 7457); RAD_INV(944, 7459); RAD_INV(945, 7477);
        RAD_INV(946, 7481); RAD_INV(947, 7487); RAD_INV(948, 7489); RAD_INV(949, 7499); RAD_INV(950, 7507);
        RAD_INV(951, 7517); RAD_INV(952, 7523); RAD_INV(953, 7529); RAD_INV(954, 7537); RAD_INV(955, 7541);
        RAD_INV(956, 7547); RAD_INV(957, 7549); RAD_INV(958, 7559); RAD_INV(959, 7561); RAD_INV(960, 7573);
        RAD_INV(961, 7577); RAD_INV(962, 7583); RAD_INV(963, 7589); RAD_INV(964, 7591); RAD_INV(965, 7603);
        RAD_INV(966, 7607); RAD_INV(967, 7621); RAD_INV(968, 7639); RAD_INV(969, 7643); RAD_INV(970, 7649);
        RAD_INV(971, 7669); RAD_INV(972, 7673); RAD_INV(973, 7681); RAD_INV(974, 7687); RAD_INV(975, 7691);
        RAD_INV(976, 7699); RAD_INV(977, 7703); RAD_INV(978, 7717); RAD_INV(979, 7723); RAD_INV(980, 7727);
        RAD_INV(981, 7741); RAD_INV(982, 7753); RAD_INV(983, 7757); RAD_INV(984, 7759); RAD_INV(985, 7789);
        RAD_INV(986, 7793); RAD_INV(987, 7817); RAD_INV(988, 7823); RAD_INV(989, 7829); RAD_INV(990, 7841);
        RAD_INV(991, 7853); RAD_INV(992, 7867); RAD_INV(993, 7873); RAD_INV(994, 7877); RAD_INV(995, 7879);
        RAD_INV(996, 7883); RAD_INV(997, 7901); RAD_INV(998, 7907); RAD_INV(999, 7919); RAD_INV(1000, 7927);
        RAD_INV(1001, 7933); RAD_INV(1002, 7937); RAD_INV(1003, 7949); RAD_INV(1004, 7951); RAD_INV(1005, 7963);
        RAD_INV(1006, 7993); RAD_INV(1007, 8009); RAD_INV(1008, 8011); RAD_INV(1009, 8017); RAD_INV(1010, 8039);
        RAD_INV(1011, 8053); RAD_INV(1012, 8059); RAD_INV(1013, 8069); RAD_INV(1014, 8081); RAD_INV(1015, 8087);
        RAD_INV(1016, 8089); RAD_INV(1017, 8093); RAD_INV(1018, 8101); RAD_INV(1019, 8111); RAD_INV(1020, 8117);
        RAD_INV(1021, 8123); RAD_INV(1022, 8147); RAD_INV(1023, 8161);
    default:
        LOG(ERROR) << STRING_PRINTF("Base %d is >= 1024, the limit of radicalInverse()", baseIndex);
        return rng.uniformFloat();
    }
}

#define SCR_INV(index, base) case index: return scrambledRadicalInverseSpecialized<base>(perm, a)

float scrambledRadicalInverse(int baseIndex, uint64_t a, const uint16_t *perm) {
    switch (baseIndex) {
    SCR_INV(0, 2);
    SCR_INV(1, 3); SCR_INV(2, 5); SCR_INV(3, 7); SCR_INV(4, 11); SCR_INV(5, 13);
    SCR_INV(6, 17); SCR_INV(7, 19); SCR_INV(8, 23); SCR_INV(9, 29); SCR_INV(10, 31);
    SCR_INV(11, 37); SCR_INV(12, 41); SCR_INV(13, 43); SCR_INV(14, 47); SCR_INV(15, 53);
    SCR_INV(16, 59); SCR_INV(17, 61); SCR_INV(18, 67); SCR_INV(19, 71); SCR_INV(20, 73);
    SCR_INV(21, 79); SCR_INV(22, 83); SCR_INV(23, 89); SCR_INV(24, 97); SCR_INV(25, 101);
    SCR_INV(26, 103); SCR_INV(27, 107); SCR_INV(28, 109); SCR_INV(29, 113); SCR_INV(30, 127);
    SCR_INV(31, 131); SCR_INV(32, 137); SCR_INV(33, 139); SCR_INV(34, 149); SCR_INV(35, 151);
    SCR_INV(36, 157); SCR_INV(37, 163); SCR_INV(38, 167); SCR_INV(39, 173); SCR_INV(40, 179);
    SCR_INV(41, 181); SCR_INV(42, 191); SCR_INV(43, 193); SCR_INV(44, 197); SCR_INV(45, 199);
    SCR_INV(46, 211); SCR_INV(47, 223); SCR_INV(48, 227); SCR_INV(49, 229); SCR_INV(50, 233);
    SCR_INV(51, 239); SCR_INV(52, 241); SCR_INV(53, 251); SCR_INV(54, 257); SCR_INV(55, 263);
    SCR_INV(56, 269); SCR_INV(57, 271); SCR_INV(58, 277); SCR_INV(59, 281); SCR_INV(60, 283);
    SCR_INV(61, 293); SCR_INV(62, 307); SCR_INV(63, 311); SCR_INV(64, 313); SCR_INV(65, 317);
    SCR_INV(66, 331); SCR_INV(67, 337); SCR_INV(68, 347); SCR_INV(69, 349); SCR_INV(70, 353);
    SCR_INV(71, 359); SCR_INV(72, 367); SCR_INV(73, 373); SCR_INV(74, 379); SCR_INV(75, 383);
    SCR_INV(76, 389); SCR_INV(77, 397); SCR_INV(78, 401); SCR_INV(79, 409); SCR_INV(80, 419);
    SCR_INV(81, 421); SCR_INV(82, 431); SCR_INV(83, 433); SCR_INV(84, 439); SCR_INV(85, 443);
    SCR_INV(86, 449); SCR_INV(87, 457); SCR_INV(88, 461); SCR_INV(89, 463); SCR_INV(90, 467);
    SCR_INV(91, 479); SCR_INV(92, 487); SCR_INV(93, 491); SCR_INV(94, 499); SCR_INV(95, 503);
    SCR_INV(96, 509); SCR_INV(97, 521); SCR_INV(98, 523); SCR_INV(99, 541); SCR_INV(100, 547);
    SCR_INV(101, 557); SCR_INV(102, 563); SCR_INV(103, 569); SCR_INV(104, 571); SCR_INV(105, 577);
    SCR_INV(106, 587); SCR_INV(107, 593); SCR_INV(108, 599); SCR_INV(109, 601); SCR_INV(110, 607);
    SCR_INV(111, 613); SCR_INV(112, 617); SCR_INV(113, 619); SCR_INV(114, 631); SCR_INV(115, 641);
    SCR_INV(116, 643); SCR_INV(117, 647); SCR_INV(118, 653); SCR_INV(119, 659); SCR_INV(120, 661);
    SCR_INV(121, 673); SCR_INV(122, 677); SCR_INV(123, 683); SCR_INV(124, 691); SCR_INV(125, 701);
    SCR_INV(126, 709); SCR_INV(127, 719); SCR_INV(128, 727); SCR_INV(129, 733); SCR_INV(130, 739);
    SCR_INV(131, 743); SCR_INV(132, 751); SCR_INV(133, 757); SCR_INV(134, 761); SCR_INV(135, 769);
    SCR_INV(136, 773); SCR_INV(137, 787); SCR_INV(138, 797); SCR_INV(139, 809); SCR_INV(140, 811);
    SCR_INV(141, 821); SCR_INV(142, 823); SCR_INV(143, 827); SCR_INV(144, 829); SCR_INV(145, 839);
    SCR_INV(146, 853); SCR_INV(147, 857); SCR_INV(148, 859); SCR_INV(149, 863); SCR_INV(150, 877);
    SCR_INV(151, 881); SCR_INV(152, 883); SCR_INV(153, 887); SCR_INV(154, 907); SCR_INV(155, 911);
    SCR_INV(156, 919); SCR_INV(157, 929); SCR_INV(158, 937); SCR_INV(159, 941); SCR_INV(160, 947);
    SCR_INV(161, 953); SCR_INV(162, 967); SCR_INV(163, 971); SCR_INV(164, 977); SCR_INV(165, 983);
    SCR_INV(166, 991); SCR_INV(167, 997); SCR_INV(168, 1009); SCR_INV(169, 1013); SCR_INV(170, 1019);
    SCR_INV(171, 1021); SCR_INV(172, 1031); SCR_INV(173, 1033); SCR_INV(174, 1039); SCR_INV(175, 1049);
    SCR_INV(176, 1051); SCR_INV(177, 1061); SCR_INV(178, 1063); SCR_INV(179, 1069); SCR_INV(180, 1087);
    SCR_INV(181, 1091); SCR_INV(182, 1093); SCR_INV(183, 1097); SCR_INV(184, 1103); SCR_INV(185, 1109);
    SCR_INV(186, 1117); SCR_INV(187, 1123); SCR_INV(188, 1129); SCR_INV(189, 1151); SCR_INV(190, 1153);
    SCR_INV(191, 1163); SCR_INV(192, 1171); SCR_INV(193, 1181); SCR_INV(194, 1187); SCR_INV(195, 1193);
    SCR_INV(196, 1201); SCR_INV(197, 1213); SCR_INV(198, 1217); SCR_INV(199, 1223); SCR_INV(200, 1229);
    SCR_INV(201, 1231); SCR_INV(202, 1237); SCR_INV(203, 1249); SCR_INV(204, 1259); SCR_INV(205, 1277);
    SCR_INV(206, 1279); SCR_INV(207, 1283); SCR_INV(208, 1289); SCR_INV(209, 1291); SCR_INV(210, 1297);
    SCR_INV(211, 1301); SCR_INV(212, 1303); SCR_INV(213, 1307); SCR_INV(214, 1319); SCR_INV(215, 1321);
    SCR_INV(216, 1327); SCR_INV(217, 1361); SCR_INV(218, 1367); SCR_INV(219, 1373); SCR_INV(220, 1381);
    SCR_INV(221, 1399); SCR_INV(222, 1409); SCR_INV(223, 1423); SCR_INV(224, 1427); SCR_INV(225, 1429);
    SCR_INV(226, 1433); SCR_INV(227, 1439); SCR_INV(228, 1447); SCR_INV(229, 1451); SCR_INV(230, 1453);
    SCR_INV(231, 1459); SCR_INV(232, 1471); SCR_INV(233, 1481); SCR_INV(234, 1483); SCR_INV(235, 1487);
    SCR_INV(236, 1489); SCR_INV(237, 1493); SCR_INV(238, 1499); SCR_INV(239, 1511); SCR_INV(240, 1523);
    SCR_INV(241, 1531); SCR_INV(242, 1543); SCR_INV(243, 1549); SCR_INV(244, 1553); SCR_INV(245, 1559);
    SCR_INV(246, 1567); SCR_INV(247, 1571); SCR_INV(248, 1579); SCR_INV(249, 1583); SCR_INV(250, 1597);
    SCR_INV(251, 1601); SCR_INV(252, 1607); SCR_INV(253, 1609); SCR_INV(254, 1613); SCR_INV(255, 1619);
    SCR_INV(256, 1621); SCR_INV(257, 1627); SCR_INV(258, 1637); SCR_INV(259, 1657); SCR_INV(260, 1663);
    SCR_INV(261, 1667); SCR_INV(262, 1669); SCR_INV(263, 1693); SCR_INV(264, 1697); SCR_INV(265, 1699);
    SCR_INV(266, 1709); SCR_INV(267, 1721); SCR_INV(268, 1723); SCR_INV(269, 1733); SCR_INV(270, 1741);
    SCR_INV(271, 1747); SCR_INV(272, 1753); SCR_INV(273, 1759); SCR_INV(274, 1777); SCR_INV(275, 1783);
    SCR_INV(276, 1787); SCR_INV(277, 1789); SCR_INV(278, 1801); SCR_INV(279, 1811); SCR_INV(280, 1823);
    SCR_INV(281, 1831); SCR_INV(282, 1847); SCR_INV(283, 1861); SCR_INV(284, 1867); SCR_INV(285, 1871);
    SCR_INV(286, 1873); SCR_INV(287, 1877); SCR_INV(288, 1879); SCR_INV(289, 1889); SCR_INV(290, 1901);
    SCR_INV(291, 1907); SCR_INV(292, 1913); SCR_INV(293, 1931); SCR_INV(294, 1933); SCR_INV(295, 1949);
    SCR_INV(296, 1951); SCR_INV(297, 1973); SCR_INV(298, 1979); SCR_INV(299, 1987); SCR_INV(300, 1993);
    SCR_INV(301, 1997); SCR_INV(302, 1999); SCR_INV(303, 2003); SCR_INV(304, 2011); SCR_INV(305, 2017);
    SCR_INV(306, 2027); SCR_INV(307, 2029); SCR_INV(308, 2039); SCR_INV(309, 2053); SCR_INV(310, 2063);
    SCR_INV(311, 2069); SCR_INV(312, 2081); SCR_INV(313, 2083); SCR_INV(314, 2087); SCR_INV(315, 2089);
    SCR_INV(316, 2099); SCR_INV(317, 2111); SCR_INV(318, 2113); SCR_INV(319, 2129); SCR_INV(320, 2131);
    SCR_INV(321, 2137); SCR_INV(322, 2141); SCR_INV(323, 2143); SCR_INV(324, 2153); SCR_INV(325, 2161);
    SCR_INV(326, 2179); SCR_INV(327, 2203); SCR_INV(328, 2207); SCR_INV(329, 2213); SCR_INV(330, 2221);
    SCR_INV(331, 2237); SCR_INV(332, 2239); SCR_INV(333, 2243); SCR_INV(334, 2251); SCR_INV(335, 2267);
    SCR_INV(336, 2269); SCR_INV(337, 2273); SCR_INV(338, 2281); SCR_INV(339, 2287); SCR_INV(340, 2293);
    SCR_INV(341, 2297); SCR_INV(342, 2309); SCR_INV(343, 2311); SCR_INV(344, 2333); SCR_INV(345, 2339);
    SCR_INV(346, 2341); SCR_INV(347, 2347); SCR_INV(348, 2351); SCR_INV(349, 2357); SCR_INV(350, 2371);
    SCR_INV(351, 2377); SCR_INV(352, 2381); SCR_INV(353, 2383); SCR_INV(354, 2389); SCR_INV(355, 2393);
    SCR_INV(356, 2399); SCR_INV(357, 2411); SCR_INV(358, 2417); SCR_INV(359, 2423); SCR_INV(360, 2437);
    SCR_INV(361, 2441); SCR_INV(362, 2447); SCR_INV(363, 2459); SCR_INV(364, 2467); SCR_INV(365, 2473);
    SCR_INV(366, 2477); SCR_INV(367, 2503); SCR_INV(368, 2521); SCR_INV(369, 2531); SCR_INV(370, 2539);
    SCR_INV(371, 2543); SCR_INV(372, 2549); SCR_INV(373, 2551); SCR_INV(374, 2557); SCR_INV(375, 2579);
    SCR_INV(376, 2591); SCR_INV(377, 2593); SCR_INV(378, 2609); SCR_INV(379, 2617); SCR_INV(380, 2621);
    SCR_INV(381, 2633); SCR_INV(382, 2647); SCR_INV(383, 2657); SCR_INV(384, 2659); SCR_INV(385, 2663);
    SCR_INV(386, 2671); SCR_INV(387, 2677); SCR_INV(388, 2683); SCR_INV(389, 2687); SCR_INV(390, 2689);
    SCR_INV(391, 2693); SCR_INV(392, 2699); SCR_INV(393, 2707); SCR_INV(394, 2711); SCR_INV(395, 2713);
    SCR_INV(396, 2719); SCR_INV(397, 2729); SCR_INV(398, 2731); SCR_INV(399, 2741); SCR_INV(400, 2749);
    SCR_INV(401, 2753); SCR_INV(402, 2767); SCR_INV(403, 2777); SCR_INV(404, 2789); SCR_INV(405, 2791);
    SCR_INV(406, 2797); SCR_INV(407, 2801); SCR_INV(408, 2803); SCR_INV(409, 2819); SCR_INV(410, 2833);
    SCR_INV(411, 2837); SCR_INV(412, 2843); SCR_INV(413, 2851); SCR_INV(414, 2857); SCR_INV(415, 2861);
    SCR_INV(416, 2879); SCR_INV(417, 2887); SCR_INV(418, 2897); SCR_INV(419, 2903); SCR_INV(420, 2909);
    SCR_INV(421, 2917); SCR_INV(422, 2927); SCR_INV(423, 2939); SCR_INV(424, 2953); SCR_INV(425, 2957);
    SCR_INV(426, 2963); SCR_INV(427, 2969); SCR_INV(428, 2971); SCR_INV(429, 2999); SCR_INV(430, 3001);
    SCR_INV(431, 3011); SCR_INV(432, 3019); SCR_INV(433, 3023); SCR_INV(434, 3037); SCR_INV(435, 3041);
    SCR_INV(436, 3049); SCR_INV(437, 3061); SCR_INV(438, 3067); SCR_INV(439, 3079); SCR_INV(440, 3083);
    SCR_INV(441, 3089); SCR_INV(442, 3109); SCR_INV(443, 3119); SCR_INV(444, 3121); SCR_INV(445, 3137);
    SCR_INV(446, 3163); SCR_INV(447, 3167); SCR_INV(448, 3169); SCR_INV(449, 3181); SCR_INV(450, 3187);
    SCR_INV(451, 3191); SCR_INV(452, 3203); SCR_INV(453, 3209); SCR_INV(454, 3217); SCR_INV(455, 3221);
    SCR_INV(456, 3229); SCR_INV(457, 3251); SCR_INV(458, 3253); SCR_INV(459, 3257); SCR_INV(460, 3259);
    SCR_INV(461, 3271); SCR_INV(462, 3299); SCR_INV(463, 3301); SCR_INV(464, 3307); SCR_INV(465, 3313);
    SCR_INV(466, 3319); SCR_INV(467, 3323); SCR_INV(468, 3329); SCR_INV(469, 3331); SCR_INV(470, 3343);
    SCR_INV(471, 3347); SCR_INV(472, 3359); SCR_INV(473, 3361); SCR_INV(474, 3371); SCR_INV(475, 3373);
    SCR_INV(476, 3389); SCR_INV(477, 3391); SCR_INV(478, 3407); SCR_INV(479, 3413); SCR_INV(480, 3433);
    SCR_INV(481, 3449); SCR_INV(482, 3457); SCR_INV(483, 3461); SCR_INV(484, 3463); SCR_INV(485, 3467);
    SCR_INV(486, 3469); SCR_INV(487, 3491); SCR_INV(488, 3499); SCR_INV(489, 3511); SCR_INV(490, 3517);
    SCR_INV(491, 3527); SCR_INV(492, 3529); SCR_INV(493, 3533); SCR_INV(494, 3539); SCR_INV(495, 3541);
    SCR_INV(496, 3547); SCR_INV(497, 3557); SCR_INV(498, 3559); SCR_INV(499, 3571); SCR_INV(500, 3581);
    SCR_INV(501, 3583); SCR_INV(502, 3593); SCR_INV(503, 3607); SCR_INV(504, 3613); SCR_INV(505, 3617);
    SCR_INV(506, 3623); SCR_INV(507, 3631); SCR_INV(508, 3637); SCR_INV(509, 3643); SCR_INV(510, 3659);
    SCR_INV(511, 3671); SCR_INV(512, 3673); SCR_INV(513, 3677); SCR_INV(514, 3691); SCR_INV(515, 3697);
    SCR_INV(516, 3701); SCR_INV(517, 3709); SCR_INV(518, 3719); SCR_INV(519, 3727); SCR_INV(520, 3733);
    SCR_INV(521, 3739); SCR_INV(522, 3761); SCR_INV(523, 3767); SCR_INV(524, 3769); SCR_INV(525, 3779);
    SCR_INV(526, 3793); SCR_INV(527, 3797); SCR_INV(528, 3803); SCR_INV(529, 3821); SCR_INV(530, 3823);
    SCR_INV(531, 3833); SCR_INV(532, 3847); SCR_INV(533, 3851); SCR_INV(534, 3853); SCR_INV(535, 3863);
    SCR_INV(536, 3877); SCR_INV(537, 3881); SCR_INV(538, 3889); SCR_INV(539, 3907); SCR_INV(540, 3911);
    SCR_INV(541, 3917); SCR_INV(542, 3919); SCR_INV(543, 3923); SCR_INV(544, 3929); SCR_INV(545, 3931);
    SCR_INV(546, 3943); SCR_INV(547, 3947); SCR_INV(548, 3967); SCR_INV(549, 3989); SCR_INV(550, 4001);
    SCR_INV(551, 4003); SCR_INV(552, 4007); SCR_INV(553, 4013); SCR_INV(554, 4019); SCR_INV(555, 4021);
    SCR_INV(556, 4027); SCR_INV(557, 4049); SCR_INV(558, 4051); SCR_INV(559, 4057); SCR_INV(560, 4073);
    SCR_INV(561, 4079); SCR_INV(562, 4091); SCR_INV(563, 4093); SCR_INV(564, 4099); SCR_INV(565, 4111);
    SCR_INV(566, 4127); SCR_INV(567, 4129); SCR_INV(568, 4133); SCR_INV(569, 4139); SCR_INV(570, 4153);
    SCR_INV(571, 4157); SCR_INV(572, 4159); SCR_INV(573, 4177); SCR_INV(574, 4201); SCR_INV(575, 4211);
    SCR_INV(576, 4217); SCR_INV(577, 4219); SCR_INV(578, 4229); SCR_INV(579, 4231); SCR_INV(580, 4241);
    SCR_INV(581, 4243); SCR_INV(582, 4253); SCR_INV(583, 4259); SCR_INV(584, 4261); SCR_INV(585, 4271);
    SCR_INV(586, 4273); SCR_INV(587, 4283); SCR_INV(588, 4289); SCR_INV(589, 4297); SCR_INV(590, 4327);
    SCR_INV(591, 4337); SCR_INV(592, 4339); SCR_INV(593, 4349); SCR_INV(594, 4357); SCR_INV(595, 4363);
    SCR_INV(596, 4373); SCR_INV(597, 4391); SCR_INV(598, 4397); SCR_INV(599, 4409); SCR_INV(600, 4421);
    SCR_INV(601, 4423); SCR_INV(602, 4441); SCR_INV(603, 4447); SCR_INV(604, 4451); SCR_INV(605, 4457);
    SCR_INV(606, 4463); SCR_INV(607, 4481); SCR_INV(608, 4483); SCR_INV(609, 4493); SCR_INV(610, 4507);
    SCR_INV(611, 4513); SCR_INV(612, 4517); SCR_INV(613, 4519); SCR_INV(614, 4523); SCR_INV(615, 4547);
    SCR_INV(616, 4549); SCR_INV(617, 4561); SCR_INV(618, 4567); SCR_INV(619, 4583); SCR_INV(620, 4591);
    SCR_INV(621, 4597); SCR_INV(622, 4603); SCR_INV(623, 4621); SCR_INV(624, 4637); SCR_INV(625, 4639);
    SCR_INV(626, 4643); SCR_INV(627, 4649); SCR_INV(628, 4651); SCR_INV(629, 4657); SCR_INV(630, 4663);
    SCR_INV(631, 4673); SCR_INV(632, 4679); SCR_INV(633, 4691); SCR_INV(634, 4703); SCR_INV(635, 4721);
    SCR_INV(636, 4723); SCR_INV(637, 4729); SCR_INV(638, 4733); SCR_INV(639, 4751); SCR_INV(640, 4759);
    SCR_INV(641, 4783); SCR_INV(642, 4787); SCR_INV(643, 4789); SCR_INV(644, 4793); SCR_INV(645, 4799);
    SCR_INV(646, 4801); SCR_INV(647, 4813); SCR_INV(648, 4817); SCR_INV(649, 4831); SCR_INV(650, 4861);
    SCR_INV(651, 4871); SCR_INV(652, 4877); SCR_INV(653, 4889); SCR_INV(654, 4903); SCR_INV(655, 4909);
    SCR_INV(656, 4919); SCR_INV(657, 4931); SCR_INV(658, 4933); SCR_INV(659, 4937); SCR_INV(660, 4943);
    SCR_INV(661, 4951); SCR_INV(662, 4957); SCR_INV(663, 4967); SCR_INV(664, 4969); SCR_INV(665, 4973);
    SCR_INV(666, 4987); SCR_INV(667, 4993); SCR_INV(668, 4999); SCR_INV(669, 5003); SCR_INV(670, 5009);
    SCR_INV(671, 5011); SCR_INV(672, 5021); SCR_INV(673, 5023); SCR_INV(674, 5039); SCR_INV(675, 5051);
    SCR_INV(676, 5059); SCR_INV(677, 5077); SCR_INV(678, 5081); SCR_INV(679, 5087); SCR_INV(680, 5099);
    SCR_INV(681, 5101); SCR_INV(682, 5107); SCR_INV(683, 5113); SCR_INV(684, 5119); SCR_INV(685, 5147);
    SCR_INV(686, 5153); SCR_INV(687, 5167); SCR_INV(688, 5171); SCR_INV(689, 5179); SCR_INV(690, 5189);
    SCR_INV(691, 5197); SCR_INV(692, 5209); SCR_INV(693, 5227); SCR_INV(694, 5231); SCR_INV(695, 5233);
    SCR_INV(696, 5237); SCR_INV(697, 5261); SCR_INV(698, 5273); SCR_INV(699, 5279); SCR_INV(700, 5281);
    SCR_INV(701, 5297); SCR_INV(702, 5303); SCR_INV(703, 5309); SCR_INV(704, 5323); SCR_INV(705, 5333);
    SCR_INV(706, 5347); SCR_INV(707, 5351); SCR_INV(708, 5381); SCR_INV(709, 5387); SCR_INV(710, 5393);
    SCR_INV(711, 5399); SCR_INV(712, 5407); SCR_INV(713, 5413); SCR_INV(714, 5417); SCR_INV(715, 5419);
    SCR_INV(716, 5431); SCR_INV(717, 5437); SCR_INV(718, 5441); SCR_INV(719, 5443); SCR_INV(720, 5449);
    SCR_INV(721, 5471); SCR_INV(722, 5477); SCR_INV(723, 5479); SCR_INV(724, 5483); SCR_INV(725, 5501);
    SCR_INV(726, 5503); SCR_INV(727, 5507); SCR_INV(728, 5519); SCR_INV(729, 5521); SCR_INV(730, 5527);
    SCR_INV(731, 5531); SCR_INV(732, 5557); SCR_INV(733, 5563); SCR_INV(734, 5569); SCR_INV(735, 5573);
    SCR_INV(736, 5581); SCR_INV(737, 5591); SCR_INV(738, 5623); SCR_INV(739, 5639); SCR_INV(740, 5641);
    SCR_INV(741, 5647); SCR_INV(742, 5651); SCR_INV(743, 5653); SCR_INV(744, 5657); SCR_INV(745, 5659);
    SCR_INV(746, 5669); SCR_INV(747, 5683); SCR_INV(748, 5689); SCR_INV(749, 5693); SCR_INV(750, 5701);
    SCR_INV(751, 5711); SCR_INV(752, 5717); SCR_INV(753, 5737); SCR_INV(754, 5741); SCR_INV(755, 5743);
    SCR_INV(756, 5749); SCR_INV(757, 5779); SCR_INV(758, 5783); SCR_INV(759, 5791); SCR_INV(760, 5801);
    SCR_INV(761, 5807); SCR_INV(762, 5813); SCR_INV(763, 5821); SCR_INV(764, 5827); SCR_INV(765, 5839);
    SCR_INV(766, 5843); SCR_INV(767, 5849); SCR_INV(768, 5851); SCR_INV(769, 5857); SCR_INV(770, 5861);
    SCR_INV(771, 5867); SCR_INV(772, 5869); SCR_INV(773, 5879); SCR_INV(774, 5881); SCR_INV(775, 5897);
    SCR_INV(776, 5903); SCR_INV(777, 5923); SCR_INV(778, 5927); SCR_INV(779, 5939); SCR_INV(780, 5953);
    SCR_INV(781, 5981); SCR_INV(782, 5987); SCR_INV(783, 6007); SCR_INV(784, 6011); SCR_INV(785, 6029);
    SCR_INV(786, 6037); SCR_INV(787, 6043); SCR_INV(788, 6047); SCR_INV(789, 6053); SCR_INV(790, 6067);
    SCR_INV(791, 6073); SCR_INV(792, 6079); SCR_INV(793, 6089); SCR_INV(794, 6091); SCR_INV(795, 6101);
    SCR_INV(796, 6113); SCR_INV(797, 6121); SCR_INV(798, 6131); SCR_INV(799, 6133); SCR_INV(800, 6143);
    SCR_INV(801, 6151); SCR_INV(802, 6163); SCR_INV(803, 6173); SCR_INV(804, 6197); SCR_INV(805, 6199);
    SCR_INV(806, 6203); SCR_INV(807, 6211); SCR_INV(808, 6217); SCR_INV(809, 6221); SCR_INV(810, 6229);
    SCR_INV(811, 6247); SCR_INV(812, 6257); SCR_INV(813, 6263); SCR_INV(814, 6269); SCR_INV(815, 6271);
    SCR_INV(816, 6277); SCR_INV(817, 6287); SCR_INV(818, 6299); SCR_INV(819, 6301); SCR_INV(820, 6311);
    SCR_INV(821, 6317); SCR_INV(822, 6323); SCR_INV(823, 6329); SCR_INV(824, 6337); SCR_INV(825, 6343);
    SCR_INV(826, 6353); SCR_INV(827, 6359); SCR_INV(828, 6361); SCR_INV(829, 6367); SCR_INV(830, 6373);
    SCR_INV(831, 6379); SCR_INV(832, 6389); SCR_INV(833, 6397); SCR_INV(834, 6421); SCR_INV(835, 6427);
    SCR_INV(836, 6449); SCR_INV(837, 6451); SCR_INV(838, 6469); SCR_INV(839, 6473); SCR_INV(840, 6481);
    SCR_INV(841, 6491); SCR_INV(842, 6521); SCR_INV(843, 6529); SCR_INV(844, 6547); SCR_INV(845, 6551);
    SCR_INV(846, 6553); SCR_INV(847, 6563); SCR_INV(848, 6569); SCR_INV(849, 6571); SCR_INV(850, 6577);
    SCR_INV(851, 6581); SCR_INV(852, 6599); SCR_INV(853, 6607); SCR_INV(854, 6619); SCR_INV(855, 6637);
    SCR_INV(856, 6653); SCR_INV(857, 6659); SCR_INV(858, 6661); SCR_INV(859, 6673); SCR_INV(860, 6679);
    SCR_INV(861, 6689); SCR_INV(862, 6691); SCR_INV(863, 6701); SCR_INV(864, 6703); SCR_INV(865, 6709);
    SCR_INV(866, 6719); SCR_INV(867, 6733); SCR_INV(868, 6737); SCR_INV(869, 6761); SCR_INV(870, 6763);
    SCR_INV(871, 6779); SCR_INV(872, 6781); SCR_INV(873, 6791); SCR_INV(874, 6793); SCR_INV(875, 6803);
    SCR_INV(876, 6823); SCR_INV(877, 6827); SCR_INV(878, 6829); SCR_INV(879, 6833); SCR_INV(880, 6841);
    SCR_INV(881, 6857); SCR_INV(882, 6863); SCR_INV(883, 6869); SCR_INV(884, 6871); SCR_INV(885, 6883);
    SCR_INV(886, 6899); SCR_INV(887, 6907); SCR_INV(888, 6911); SCR_INV(889, 6917); SCR_INV(890, 6947);
    SCR_INV(891, 6949); SCR_INV(892, 6959); SCR_INV(893, 6961); SCR_INV(894, 6967); SCR_INV(895, 6971);
    SCR_INV(896, 6977); SCR_INV(897, 6983); SCR_INV(898, 6991); SCR_INV(899, 6997); SCR_INV(900, 7001);
    SCR_INV(901, 7013); SCR_INV(902, 7019); SCR_INV(903, 7027); SCR_INV(904, 7039); SCR_INV(905, 7043);
    SCR_INV(906, 7057); SCR_INV(907, 7069); SCR_INV(908, 7079); SCR_INV(909, 7103); SCR_INV(910, 7109);
    SCR_INV(911, 7121); SCR_INV(912, 7127); SCR_INV(913, 7129); SCR_INV(914, 7151); SCR_INV(915, 7159);
    SCR_INV(916, 7177); SCR_INV(917, 7187); SCR_INV(918, 7193); SCR_INV(919, 7207); SCR_INV(920, 7211);
    SCR_INV(921, 7213); SCR_INV(922, 7219); SCR_INV(923, 7229); SCR_INV(924, 7237); SCR_INV(925, 7243);
    SCR_INV(926, 7247); SCR_INV(927, 7253); SCR_INV(928, 7283); SCR_INV(929, 7297); SCR_INV(930, 7307);
    SCR_INV(931, 7309); SCR_INV(932, 7321); SCR_INV(933, 7331); SCR_INV(934, 7333); SCR_INV(935, 7349);
    SCR_INV(936, 7351); SCR_INV(937, 7369); SCR_INV(938, 7393); SCR_INV(939, 7411); SCR_INV(940, 7417);
    SCR_INV(941, 7433); SCR_INV(942, 7451); SCR_INV(943, 7457); SCR_INV(944, 7459); SCR_INV(945, 7477);
    SCR_INV(946, 7481); SCR_INV(947, 7487); SCR_INV(948, 7489); SCR_INV(949, 7499); SCR_INV(950, 7507);
    SCR_INV(951, 7517); SCR_INV(952, 7523); SCR_INV(953, 7529); SCR_INV(954, 7537); SCR_INV(955, 7541);
    SCR_INV(956, 7547); SCR_INV(957, 7549); SCR_INV(958, 7559); SCR_INV(959, 7561); SCR_INV(960, 7573);
    SCR_INV(961, 7577); SCR_INV(962, 7583); SCR_INV(963, 7589); SCR_INV(964, 7591); SCR_INV(965, 7603);
    SCR_INV(966, 7607); SCR_INV(967, 7621); SCR_INV(968, 7639); SCR_INV(969, 7643); SCR_INV(970, 7649);
    SCR_INV(971, 7669); SCR_INV(972, 7673); SCR_INV(973, 7681); SCR_INV(974, 7687); SCR_INV(975, 7691);
    SCR_INV(976, 7699); SCR_INV(977, 7703); SCR_INV(978, 7717); SCR_INV(979, 7723); SCR_INV(980, 7727);
    SCR_INV(981, 7741); SCR_INV(982, 7753); SCR_INV(983, 7757); SCR_INV(984, 7759); SCR_INV(985, 7789);
    SCR_INV(986, 7793); SCR_INV(987, 7817); SCR_INV(988, 7823); SCR_INV(989, 7829); SCR_INV(990, 7841);
    SCR_INV(991, 7853); SCR_INV(992, 7867); SCR_INV(993, 7873); SCR_INV(994, 7877); SCR_INV(995, 7879);
    SCR_INV(996, 7883); SCR_INV(997, 7901); SCR_INV(998, 7907); SCR_INV(999, 7919); SCR_INV(1000, 7927);
    SCR_INV(1001, 7933); SCR_INV(1002, 7937); SCR_INV(1003, 7949); SCR_INV(1004, 7951); SCR_INV(1005, 7963);
    SCR_INV(1006, 7993); SCR_INV(1007, 8009); SCR_INV(1008, 8011); SCR_INV(1009, 8017); SCR_INV(1010, 8039);
    SCR_INV(1011, 8053); SCR_INV(1012, 8059); SCR_INV(1013, 8069); SCR_INV(1014, 8081); SCR_INV(1015, 8087);
    SCR_INV(1016, 8089); SCR_INV(1017, 8093); SCR_INV(1018, 8101); SCR_INV(1019, 8111); SCR_INV(1020, 8117);
    SCR_INV(1021, 8123); SCR_INV(1022, 8147); SCR_INV(1023, 8161);
    default:
        LOG(ERROR) << STRING_PRINTF("Base %d is >= 1024, the limit of scrambledRadicalInverse()", baseIndex);
        return rng.uniformFloat();
    }
}

int Primes[PrimeTableSize] = {
    2, 3, 5, 7, 11,
    13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89,
    97, 101, 103, 107, 109, 113, 127, 131, 137, 139, 149, 151, 157, 163, 167,
    173, 179, 181, 191, 193, 197, 199, 211, 223, 227, 229, 233, 239, 241, 251,
    257, 263, 269, 271, 277, 281, 283, 293, 307, 311, 313, 317, 331, 337, 347,
    349, 353, 359, 367, 373, 379, 383, 389, 397, 401, 409, 419, 421, 431, 433,
    439, 443, 449, 457, 461, 463, 467, 479, 487, 491, 499, 503, 509, 521, 523,
    541, 547, 557, 563, 569, 571, 577, 587, 593, 599, 601, 607, 613, 617, 619,
    631, 641, 643, 647, 653, 659, 661, 673, 677, 683, 691, 701, 709, 719, 727,
    733, 739, 743, 751, 757, 761, 769, 773, 787, 797, 809, 811, 821, 823, 827,
    829, 839, 853, 857, 859, 863, 877, 881, 883, 887, 907, 911, 919, 929, 937,
    941, 947, 953, 967, 971, 977, 983, 991, 997, 1009, 1013, 1019, 1021, 1031,
    1033, 1039, 1049, 1051, 1061, 1063, 1069, 1087, 1091, 1093, 1097, 1103,
    1109, 1117, 1123, 1129, 1151, 1153, 1163, 1171, 1181, 1187, 1193, 1201,
    1213, 1217, 1223, 1229, 1231, 1237, 1249, 1259, 1277, 1279, 1283, 1289,
    1291, 1297, 1301, 1303, 1307, 1319, 1321, 1327, 1361, 1367, 1373, 1381,
    1399, 1409, 1423, 1427, 1429, 1433, 1439, 1447, 1451, 1453, 1459, 1471,
    1481, 1483, 1487, 1489, 1493, 1499, 1511, 1523, 1531, 1543, 1549, 1553,
    1559, 1567, 1571, 1579, 1583, 1597, 1601, 1607, 1609, 1613, 1619, 1621,
    1627, 1637, 1657, 1663, 1667, 1669, 1693, 1697, 1699, 1709, 1721, 1723,
    1733, 1741, 1747, 1753, 1759, 1777, 1783, 1787, 1789, 1801, 1811, 1823,
    1831, 1847, 1861, 1867, 1871, 1873, 1877, 1879, 1889, 1901, 1907, 1913,
    1931, 1933, 1949, 1951, 1973, 1979, 1987, 1993, 1997, 1999, 2003, 2011,
    2017, 2027, 2029, 2039, 2053, 2063, 2069, 2081, 2083, 2087, 2089, 2099,
    2111, 2113, 2129, 2131, 2137, 2141, 2143, 2153, 2161, 2179, 2203, 2207,
    2213, 2221, 2237, 2239, 2243, 2251, 2267, 2269, 2273, 2281, 2287, 2293,
    2297, 2309, 2311, 2333, 2339, 2341, 2347, 2351, 2357, 2371, 2377, 2381,
    2383, 2389, 2393, 2399, 2411, 2417, 2423, 2437, 2441, 2447, 2459, 2467,
    2473, 2477, 2503, 2521, 2531, 2539, 2543, 2549, 2551, 2557, 2579, 2591,
    2593, 2609, 2617, 2621, 2633, 2647, 2657, 2659, 2663, 2671, 2677, 2683,
    2687, 2689, 2693, 2699, 2707, 2711, 2713, 2719, 2729, 2731, 2741, 2749,
    2753, 2767, 2777, 2789, 2791, 2797, 2801, 2803, 2819, 2833, 2837, 2843,
    2851, 2857, 2861, 2879, 2887, 2897, 2903, 2909, 2917, 2927, 2939, 2953,
    2957, 2963, 2969, 2971, 2999, 3001, 3011, 3019, 3023, 3037, 3041, 3049,
    3061, 3067, 3079, 3083, 3089, 3109, 3119, 3121, 3137, 3163, 3167, 3169,
    3181, 3187, 3191, 3203, 3209, 3217, 3221, 3229, 3251, 3253, 3257, 3259,
    3271, 3299, 3301, 3307, 3313, 3319, 3323, 3329, 3331, 3343, 3347, 3359,
    3361, 3371, 3373, 3389, 3391, 3407, 3413, 3433, 3449, 3457, 3461, 3463,
    3467, 3469, 3491, 3499, 3511, 3517, 3527, 3529, 3533, 3539, 3541, 3547,
    3557, 3559, 3571, 3581, 3583, 3593, 3607, 3613, 3617, 3623, 3631, 3637,
    3643, 3659, 3671, 3673, 3677, 3691, 3697, 3701, 3709, 3719, 3727, 3733,
    3739, 3761, 3767, 3769, 3779, 3793, 3797, 3803, 3821, 3823, 3833, 3847,
    3851, 3853, 3863, 3877, 3881, 3889, 3907, 3911, 3917, 3919, 3923, 3929,
    3931, 3943, 3947, 3967, 3989, 4001, 4003, 4007, 4013, 4019, 4021, 4027,
    4049, 4051, 4057, 4073, 4079, 4091, 4093, 4099, 4111, 4127, 4129, 4133,
    4139, 4153, 4157, 4159, 4177, 4201, 4211, 4217, 4219, 4229, 4231, 4241,
    4243, 4253, 4259, 4261, 4271, 4273, 4283, 4289, 4297, 4327, 4337, 4339,
    4349, 4357, 4363, 4373, 4391, 4397, 4409, 4421, 4423, 4441, 4447, 4451,
    4457, 4463, 4481, 4483, 4493, 4507, 4513, 4517, 4519, 4523, 4547, 4549,
    4561, 4567, 4583, 4591, 4597, 4603, 4621, 4637, 4639, 4643, 4649, 4651,
    4657, 4663, 4673, 4679, 4691, 4703, 4721, 4723, 4729, 4733, 4751, 4759,
    4783, 4787, 4789, 4793, 4799, 4801, 4813, 4817, 4831, 4861, 4871, 4877,
    4889, 4903, 4909, 4919, 4931, 4933, 4937, 4943, 4951, 4957, 4967, 4969,
    4973, 4987, 4993, 4999, 5003, 5009, 5011, 5021, 5023, 5039, 5051, 5059,
    5077, 5081, 5087, 5099, 5101, 5107, 5113, 5119, 5147, 5153, 5167, 5171,
    5179, 5189, 5197, 5209, 5227, 5231, 5233, 5237, 5261, 5273, 5279, 5281,
    5297, 5303, 5309, 5323, 5333, 5347, 5351, 5381, 5387, 5393, 5399, 5407,
    5413, 5417, 5419, 5431, 5437, 5441, 5443, 5449, 5471, 5477, 5479, 5483,
    5501, 5503, 5507, 5519, 5521, 5527, 5531, 5557, 5563, 5569, 5573, 5581,
    5591, 5623, 5639, 5641, 5647, 5651, 5653, 5657, 5659, 5669, 5683, 5689,
    5693, 5701, 5711, 5717, 5737, 5741, 5743, 5749, 5779, 5783, 5791, 5801,
    5807, 5813, 5821, 5827, 5839, 5843, 5849, 5851, 5857, 5861, 5867, 5869,
    5879, 5881, 5897, 5903, 5923, 5927, 5939, 5953, 5981, 5987, 6007, 6011,
    6029, 6037, 6043, 6047, 6053, 6067, 6073, 6079, 6089, 6091, 6101, 6113,
    6121, 6131, 6133, 6143, 6151, 6163, 6173, 6197, 6199, 6203, 6211, 6217,
    6221, 6229, 6247, 6257, 6263, 6269, 6271, 6277, 6287, 6299, 6301, 6311,
    6317, 6323, 6329, 6337, 6343, 6353, 6359, 6361, 6367, 6373, 6379, 6389,
    6397, 6421, 6427, 6449, 6451, 6469, 6473, 6481, 6491, 6521, 6529, 6547,
    6551, 6553, 6563, 6569, 6571, 6577, 6581, 6599, 6607, 6619, 6637, 6653,
    6659, 6661, 6673, 6679, 6689, 6691, 6701, 6703, 6709, 6719, 6733, 6737,
    6761, 6763, 6779, 6781, 6791, 6793, 6803, 6823, 6827, 6829, 6833, 6841,
    6857, 6863, 6869, 6871, 6883, 6899, 6907, 6911, 6917, 6947, 6949, 6959,
    6961, 6967, 6971, 6977, 6983, 6991, 6997, 7001, 7013, 7019, 7027, 7039,
    7043, 7057, 7069, 7079, 7103, 7109, 7121, 7127, 7129, 7151, 7159, 7177,
    7187, 7193, 7207, 7211, 7213, 7219, 7229, 7237, 7243, 7247, 7253, 7283,
    7297, 7307, 7309, 7321, 7331, 7333, 7349, 7351, 7369, 7393, 7411, 7417,
    7433, 7451, 7457, 7459, 7477, 7481, 7487, 7489, 7499, 7507, 7517, 7523,
    7529, 7537, 7541, 7547, 7549, 7559, 7561, 7573, 7577, 7583, 7589, 7591,
    7603, 7607, 7621, 7639, 7643, 7649, 7669, 7673, 7681, 7687, 7691, 7699,
    7703, 7717, 7723, 7727, 7741, 7753, 7757, 7759, 7789, 7793, 7817, 7823,
    7829, 7841, 7853, 7867, 7873, 7877, 7879, 7883, 7901, 7907, 7919, 7927,
    7933, 7937, 7949, 7951, 7963, 7993, 8009, 8011, 8017, 8039, 8053, 8059,
    8069, 8081, 8087, 8089, 8093, 8101, 8111, 8117, 8123, 8147, 8161
};

}
